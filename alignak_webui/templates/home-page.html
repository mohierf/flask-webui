{# alignak_webui/templates/home-page.html_ #}

{% extends "layout.html" %}
{% block title %}Home page{% endblock %}
{% block body %}
    {{ super() }}
    {% if settings.get('layout.graph', 'false') != "false" %}
    <h2 class="page-header">System status</h2>
    <div class="row">
        <div class="row">
            <div class="col-xs-12 col-sm-6 col-md-4">
                <canvas id="myChart1" style="height: 60px"></canvas>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-2">
                <canvas id="myChart2_1" style="height: 60px"></canvas>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-2">
                <canvas id="myChart2_2" style="height: 60px"></canvas>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-4">
                <canvas id="myChart3" style="height: 60px"></canvas>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-6 col-md-4">
            <center>
                <h4>Label</h4>
                <span class="text-muted">Chart 1</span>
            </center>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-2">
            <center>
                <h4>Hosts states</h4>
                <span class="text-muted">Chart 2.1</span>
            </center>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-2">
            <center>
                <h4>Services states</h4>
                <span class="text-muted">Chart 2.2</span>
            </center>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-4">
            <center>
                <h4>Label</h4>
                <span class="text-muted">Chart 3</span>
            </center>
            </div>
        </div>
    </div>
    <script>
    $(document).ready(function(){
        Chart.defaults.global.responsive = true;

        if ($("#myChart1").length !== 0) {
          // Line chart
          var data = {
              labels: ["January", "February", "March", "April", "May", "June", "July"],
              datasets: [
                  {
                      label: "My First dataset",
                      fillColor: "rgba(220,220,220,0.2)",
                      strokeColor: "rgba(220,220,220,1)",
                      pointColor: "rgba(220,220,220,1)",
                      pointStrokeColor: "#fff",
                      pointHighlightFill: "#fff",
                      pointHighlightStroke: "rgba(220,220,220,1)",
                      data: [65, 59, 80, 81, 56, 55, 40]
                  },
                  {
                      label: "My Second dataset",
                      fillColor: "rgba(151,187,205,0.2)",
                      strokeColor: "rgba(151,187,205,1)",
                      pointColor: "rgba(151,187,205,1)",
                      pointStrokeColor: "#fff",
                      pointHighlightFill: "#fff",
                      pointHighlightStroke: "rgba(151,187,205,1)",
                      data: [28, 48, 40, 19, 86, 27, 90]
                  }
              ]
          };
          // Get the context of the canvas element we want to select
          var ctx = $("#myChart1").get(0).getContext("2d");
          // var ctx = document.getElementById("myChart1").getContext("2d");
          var myLineChart = new Chart(ctx).Line(data);
       }


       if ($("#myChart2_1").length !== 0) {
          // Pie chart
          var data = [
              {
                  value: 90,
                  color:"#5bb75b",
                  highlight: "#5AD3D1",
                  label: "Up"
              },
              {
                  value: 10,
                  color: "#faa732",
                  highlight: "#5AD3D1",
                  label: "Unreachable"
              },
              {
                  value: 5,
                  color: "#da4f49",
                  highlight: "#5AD3D1",
                  label: "Down"
              }
          ]
          // Get the context of the canvas element we want to select
          var ctx = $("#myChart2_1").get(0).getContext("2d");
          var myPieChart = new Chart(ctx).Pie(data);
       }
       if ($("#myChart2_2").length !== 0) {
          // Pie chart
          var data = [
              {
                  value: 300,
                  color:"#5bb75b",
                  highlight: "#5AD3D1",
                  label: "Ok"
              },
              {
                  value: 100,
                  color: "#faa732",
                  highlight: "#5AD3D1",
                  label: "Warning"
              },
              {
                  value: 50,
                  color: "#da4f49",
                  highlight: "#5AD3D1",
                  label: "Critical"
              }
          ]
          // Get the context of the canvas element we want to select
          var ctx = $("#myChart2_2").get(0).getContext("2d");
          var myPieChart = new Chart(ctx).Pie(data);
       }

       if ($("#myChart3").length !== 0) {
          // Bar chart
          var data = {
              labels: ["January", "February", "March", "April", "May", "June", "July"],
              datasets: [
                  {
                      label: "My First dataset",
                      fillColor: "rgba(220,220,220,0.5)",
                      strokeColor: "rgba(220,220,220,0.8)",
                      highlightFill: "rgba(220,220,220,0.75)",
                      highlightStroke: "rgba(220,220,220,1)",
                      data: [65, 59, 80, 81, 56, 55, 40]
                  },
                  {
                      label: "My Second dataset",
                      fillColor: "rgba(151,187,205,0.5)",
                      strokeColor: "rgba(151,187,205,0.8)",
                      highlightFill: "rgba(151,187,205,0.75)",
                      highlightStroke: "rgba(151,187,205,1)",
                      data: [28, 48, 40, 19, 86, 27, 90]
                  }
              ]
          };
          // Get the context of the canvas element we want to select
          var ctx = $("#myChart3").get(0).getContext("2d");
          var myBarChart = new Chart(ctx).Bar(data);
       }
    });
    </script>
    {% endif %}

    <h2 class="page-header">Problems</h2>
    <div class="row">
        <div class="panel panel-default">
            <div class="panel-body">
                <button type="button" class="btn btn-default btn-xs pull-left" data-type="business-impact" data-business-impact="5" data-state="off">Select all elements</button>

                <i class="pull-right small">1 elements</i>
                <h3 class="text-center">Business impact: {{ helper.get_business_impact_text(5, icon=True, text=True)|safe }}</h3>

                <!-- TODO ... data- ... -->
                <table class="table table-invisible table-condensed" style="table-layout:fixed;width:100%;">
                    <thead><tr>
                        <th width="20px"></th>
                        <th width="40px"></th>
                        <th width="60px">Host</th>
                        <th width="90px">Service</th>
                        <th width="90px">State</th>
                        <th width="90px">Duration</th>
                        <th class="hidden-sm hidden-xs" width="100%">Output</th>
                    </tr></thead>

                    <tbody>
                        <tr data-toggle="collapse" data-target="#details-1" class="accordion-toggle">
                            <td>
                                <input type="checkbox" class="input-sm" value="" id="selector-1" data-type="problem" data-business-impact="0" data-item="xxxx">
                            </td>
                            <td align="center">
                                {{ helper.get_state_text("host", "down", label="", disabled=False)|safe }}
                            </td>
                            <td>
                                {{ helper.get_url("host", "host1", label="Host 1")|safe }}
                            </td>
                            <td>
                                {{ helper.get_url("service", "service1", label="Service 1")|safe }}
                                <button class="btn btn-danger btn-xs"><i class="fa fa-plus"></i> 12 impacts</button>
                            </td>
                            <td class="font-down"><strong>DOWN</strong></td>
                            <td >since 18h</td>
                            <td class="row hidden-sm hidden-xs">
                                <div class="ellipsis output">
                                    Check output ...
                                    <div class="long-output">
                                        Long check output ...Long check output ...Long check output ...Long check output ...Long check output ...
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="8" class="hiddenRow">
                                <div class="accordion-body collapse" id="details-1">
                                    <table class="table table-condensed" style="margin:0;">
                                        <tr>
                                            <td align="center" class="visible-lg">Realm XXXX</td>
                                            <td align="left">
                                                <i class="fa fa-arrow-left" title="Passive checks are enabled."></i>
                                                <i title="Freshness check is enabled">(Freshness threshold: 1800 seconds)</i>
                                            </td>
                                            <td align="left">
                                                <i class="fa fa-arrow-right" title="Active checks are enabled."></i>
                                                <i>Last check <strong>12s ago</strong>, next check in <strong>13 mn</strong>, attempt <strong>1/3</strong></i>
                                            </td>
                                            {% if current_user.can_action %}
                                            <td align="right">
                                                <div class="btn-group" role="group" data-type="actions" aria-label="Actions">
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="event-handler"
                                                    data-toggle="tooltip" data-placement="bottom" title="Try to fix (launch event handler)"
                                                    data-element="test">
                                                    <i class="fa fa-magic"></i><span class="hidden-sm hidden-xs"> Try to fix</span>
                                                    </button>
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="recheck"
                                                    data-toggle="tooltip" data-placement="bottom" title="Launch the check command"
                                                    data-element="test">
                                                    <i class="fa fa-refresh"></i><span class="hidden-sm hidden-xs"> Refresh</span>
                                                    </button>
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="check-result"
                                                    data-toggle="tooltip" data-placement="bottom" title="Submit a check result"
                                                    data-element="test"
                                                    data-user="utilisateur">
                                                    <i class="fa fa-share"></i><span class="hidden-sm hidden-xs"> Submit check result</span>
                                                    </button>
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="add-acknowledge"
                                                    data-toggle="tooltip" data-placement="bottom" title="Acknowledge this problem"
                                                    data-element="test">
                                                    <i class="fa fa-check"></i><span class="hidden-sm hidden-xs"> Acknowledge</span>
                                                    </button>
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="schedule-downtime"
                                                    data-toggle="tooltip" data-placement="bottom" title="Schedule a downtime for this problem"
                                                    data-element="test">
                                                    <i class="fa fa-ambulance"></i><span class="hidden-sm hidden-xs"> Downtime</span>
                                                    </button>
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="ignore-checks"
                                                    data-toggle="tooltip" data-placement="bottom" title="Ignore checks for the service (disable checks, notifications, event handlers and force Ok)"
                                                    data-element="test"
                                                    data-user="utilisateur">
                                                    <i class="fa fa-eraser"></i><span class="hidden-sm hidden-xs"> Remove</span>
                                                    </button>
                                                </div>
                                            </td>
                                            {% endif %}
                                        </tr>
                                    </table>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-body">
                <button type="button" class="btn btn-default btn-xs pull-left" data-type="business-impact" data-business-impact="4" data-state="off">Select all elements</button>

                <i class="pull-right small">5 elements</i>
                <h3 class="text-center">Business impact: {{ helper.get_business_impact_text(4, icon=True, text=True)|safe }}</h3>

                <!-- TODO ... data- ... -->
                <table class="table table-invisible table-condensed" style="table-layout:fixed;width:100%;">
                    <thead><tr>
                        <th width="20px"></th>
                        <th width="40px"></th>
                        <th width="60px">Host</th>
                        <th width="90px">Service</th>
                        <th width="90px">State</th>
                        <th width="90px">Duration</th>
                        <th class="hidden-sm hidden-xs" width="100%">Output</th>
                    </tr></thead>

                    <tbody>
                        {% for i in ['2','3','4','5','6'] %}
                        <tr data-toggle="collapse" data-target="#details-{{i}}" class="accordion-toggle">
                            <td>
                                <input type="checkbox" class="input-sm" value="" id="selector-{{i}}" data-type="problem" data-business-impact="0" data-item="xxxx">
                            </td>
                            <td align="center">
                                {{ helper.get_state_text("host", "down", label="", disabled=False)|safe }}
                            </td>
                            <td>
                                {{ helper.get_url("host", "host1", label="Host 1")|safe }}
                            </td>
                            <td>
                                {{ helper.get_url("service", "service1", label="Service 1")|safe }}
                                <button class="btn btn-danger btn-xs"><i class="fa fa-plus"></i> 12 impacts</button>
                            </td>
                            <td class="font-down"><strong>DOWN</strong></td>
                            <td >since 18h</td>
                            <td class="row hidden-sm hidden-xs">
                                Check output
                                <button type="button" class="btn btn-xs btn-info" data-toggle="popover" title="Long output" data-content="Long check output ...Long check output ...Long check output ...Long check output ...Long check output ...">
                                Long output
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="20" class="hiddenRow">
                                <div class="accordion-body collapse" id="details-{{i}}">
                                    <table class="table table-condensed" style="margin:0;">
                                        <tr>
                                            <td align="center" class="visible-lg">Realm XXXX</td>
                                            <td align="left">
                                                <i class="fa fa-arrow-left" title="Passive checks are enabled."></i>
                                                <i title="Freshness check is enabled">(Freshness threshold: 1800 seconds)</i>
                                            </td>
                                            <td align="left">
                                                <i class="fa fa-arrow-right" title="Active checks are enabled."></i>
                                                <i>Last check <strong>12s ago</strong>, next check in <strong>13 mn</strong>, attempt <strong>1/3</strong></i>
                                            </td>
                                            %if user.can_action():
                                            <td align="right">
                                                <div class="btn-group" role="group" data-type="actions" aria-label="Actions">
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="event-handler"
                                                    data-toggle="tooltip" data-placement="bottom" title="Try to fix (launch event handler)"
                                                    data-element="test">
                                                    <i class="fa fa-magic"></i><span class="hidden-sm hidden-xs"> Try to fix</span>
                                                    </button>
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="recheck"
                                                    data-toggle="tooltip" data-placement="bottom" title="Launch the check command"
                                                    data-element="test">
                                                    <i class="fa fa-refresh"></i><span class="hidden-sm hidden-xs"> Refresh</span>
                                                    </button>
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="check-result"
                                                    data-toggle="tooltip" data-placement="bottom" title="Submit a check result"
                                                    data-element="test"
                                                    data-user="utilisateur">
                                                    <i class="fa fa-share"></i><span class="hidden-sm hidden-xs"> Submit check result</span>
                                                    </button>
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="add-acknowledge"
                                                    data-toggle="tooltip" data-placement="bottom" title="Acknowledge this problem"
                                                    data-element="test">
                                                    <i class="fa fa-check"></i><span class="hidden-sm hidden-xs"> Acknowledge</span>
                                                    </button>
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="schedule-downtime"
                                                    data-toggle="tooltip" data-placement="bottom" title="Schedule a downtime for this problem"
                                                    data-element="test">
                                                    <i class="fa fa-ambulance"></i><span class="hidden-sm hidden-xs"> Downtime</span>
                                                    </button>
                                                    <button class="btn btn-default btn-xs"
                                                    data-type="action" action="ignore-checks"
                                                    data-toggle="tooltip" data-placement="bottom" title="Ignore checks for the service (disable checks, notifications, event handlers and force Ok)"
                                                    data-element="test"
                                                    data-user="utilisateur">
                                                    <i class="fa fa-eraser"></i><span class="hidden-sm hidden-xs"> Remove</span>
                                                    </button>
                                                </div>
                                            </td>
                                            %end
                                        </tr>
                                    </table>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}
